; PlatformIO Project Configuration File
;
; Build options: build flags, source filter
; Upload options: custom upload port, speed and extra flags
; Library options: dependencies, extra library storages
; Advanced options: extra scripting
;
; Please visit documentation for the other options and examples
; https://docs.platformio.org/page/projectconf.html
; ESP32 Boiler Controller - Ethernet (LAN8720), MB8ART, RYN4, Arduino core 3.3.x

[platformio]
default_envs = esp32dev_usb_debug_selective
; default_envs = esp32dev_usb_debug_full
; default_envs = esp32dev_usb_release
; default_envs = esp32dev_test_debug_selective
extra_configs = credentials.ini

; -------------------------------------------------------------------
; Shared Environment Settings
[env_defaults]
; Use stable platform instead of develop
platform = https://github.com/pioarduino/platform-espressif32/releases/download/stable/platform-espressif32.zip
; platform = https://github.com/pioarduino/platform-espressif32.git#develop
framework = arduino
board = esp32dev

; Use a larger partition scheme for bigger programs
board_build.flash_size = 16MB
board_build.partitions = hardware/partitions_16MB.csv

board_build.flash_mode = dio      # or qio if supported
board_build.f_flash = 40000000L   # 40MHz flash speed

; Or use one of these alternatives:
; board_build.partitions = huge_app.csv
; board_build.partitions = no_ota.csv      ; 2MB app (no OTA)
; board_build.partitions = min_spiffs.csv  ; 1.9MB app, minimal SPIFFS
; board_build.partitions = default_8MB.csv ; If you have 8MB flash

monitor_port = /dev/ttyACM0
monitor_speed = 921600  ; 8x faster than 115200 to prevent log buffer overflow  ; Increased to match SERIAL_BAUD_RATE for better throughput
monitor_filters = 
    direct           ; No processing, show raw output
    ; time             ; Add timestamps to each line
    esp32_exception_decoder
monitor_rts = 0      ; Don't toggle RTS (helps with connection stability)
monitor_dtr = 0      ; Don't toggle DTR (helps with connection stability)
check_skip_packages = yes

; Library dependency finder mode
lib_ldf_mode = deep+

; Library dependencies - Local development uses file:// paths
; For GitHub/production, use GitHub URLs (see platformio.github.ini.example)
; Paths use ${sysenv.HOME} for portability across users
lib_deps =
    ; Foundation libraries
    https://github.com/packerlschupfer/ESP32-LibraryCommon.git
    https://github.com/packerlschupfer/ESP32-Logger.git
    https://github.com/packerlschupfer/ESP32-SemaphoreGuard.git
    https://github.com/packerlschupfer/ESP32-MutexGuard.git

    ; Task and system management
    https://github.com/packerlschupfer/ESP32-Watchdog.git
    https://github.com/packerlschupfer/ESP32-TaskManager.git

    ; Network and OTA
    https://github.com/packerlschupfer/ESP32-EthernetManager.git
    https://github.com/packerlschupfer/ESP32-OTAManager.git

    ; Time synchronization
    https://github.com/packerlschupfer/ESP32-NTPClient.git
    https://github.com/packerlschupfer/ESP32-DS3231Controller.git

    ; Storage
    https://github.com/packerlschupfer/ESP32-PersistentStorage.git
    https://github.com/packerlschupfer/ESP32-RuntimeStorage.git

    ; MQTT communication
    https://github.com/packerlschupfer/ESP32-MQTTClient.git
    https://github.com/packerlschupfer/ESP32-MQTTManager.git

    ; Modbus framework
    https://github.com/packerlschupfer/esp32ModbusRTU.git
    https://github.com/packerlschupfer/ESP32-IDeviceInstance.git
    https://github.com/packerlschupfer/ESP32-ModbusDevice.git

    ; Modbus hardware drivers
    https://github.com/packerlschupfer/ESP32-MB8ART.git
    https://github.com/packerlschupfer/ESP32-RYN4.git
    https://github.com/packerlschupfer/ESP32-ANDRTF3.git

    ; JSON support
    bblanchon/ArduinoJson@^7.4.2
    
    ; Other dependencies
    ; me-no-dev/ESPAsyncWebServer@^1.2.3  ; If web interface needed

; Extra scripts (run during build process)
extra_scripts =
    pre:scripts/check_credentials.py        ; Check credentials.ini before build
    pre:scripts/build/auto_firmware_version.py  ; Auto-version firmware

; Include credentials file if it exists (DO NOT COMMIT TO GIT)
; Copy credentials.example.ini to credentials.ini and add your credentials
; NOTE: extra_configs already defined at line 17

; Ignore libraries that cause conflicts
lib_ignore = 
    WiFi

; -------------------------------------------------------------------
[base]
build_type = release
build_flags = 
    -Wall                        ; Enable all warnings
    -Wuninitialized              ; Warn about uninitialized variables
    -Wsign-compare               ; Warn about signed/unsigned comparisons
    ; -Wno-unused-const-variable   ; Suppress unused const variable warnings
    ; -Wno-macro-redefined       ; Suppress macro redefinition warnings (PlatformIO issue) - commented to find root cause
    ; -Wextra                    ; Too many framework warnings
    ; -Wconversion               ; Too aggressive for Arduino framework
    -std=gnu++11                 ; C++11 standard
    
    ; Include paths for library dependencies
    -I include                   ; Project include directory (for LogInterface.h redirect)
    

    ; -D ESP32                    ; Already defined by PlatformIO
    -D ARDUINO_ARCH_ESP32
    
    ; Logging buffer size - removed, defined in DebugMacros.h based on build mode
    
    ; Serial/UART configuration for better log handling
    -D SERIAL_TX_BUFFER_SIZE=1024  ; Increase TX buffer
    -D SERIAL_RX_BUFFER_SIZE=256   ; Standard RX buffer

    ; Ethernet configuration
    -D CONFIG_ETH_ENABLED=1      ; Enable Ethernet
    -D CONFIG_ETH_USE_ESP32_EMAC=1
    -D ETH_PHY_INTERFACE=ETH_PHY_RMII
    -D ETH_RMII_CLK_OUTPUT=1
    -D ETH_RMII_CLK_OUT_GPIO=17
    
    ; Disable all wireless features
    ; Note: BT config values removed - framework defines them but we don't use BT
    ; -D CONFIG_BT_ENABLED=0       ; Removed - causes redefinition warning
    ; -D CONFIG_BT_BLE_ENABLED=0   ; Removed - causes redefinition warning
    ; -D CONFIG_BT_NIMBLE_ENABLED=0 ; Keep this to ensure NimBLE is disabled
    
    -D CONFIG_WIFI_ENABLED=0     ; Disable WiFi
    -D CONFIG_MDNS_DISABLE=1     ; Disable mDNS if not needed
    
    ; MQTT stack optimization
    -D CONFIG_MQTT_TASK_STACK_SIZE=4096     ; Reduce internal MQTT task stack
    
    ; System task stack optimization (these may not work if compiled into framework)
    ; We override weak functions in main.cpp instead
    ; -D CONFIG_ARDUINO_EVENT_TASK_STACK_SIZE=3072  ; Doesn't work - use override function
    ; -D CONFIG_TIMER_TASK_STACK_SIZE=3072          ; Doesn't work - use override function
    
    ; Arduino v3.x specific flags
    -D ARDUINO_USB_MODE=0
    -D ARDUINO_USB_CDC_ON_BOOT=0
    
    ; Project identification
    -D PROJECT_NAME=\"ESPlan-Boiler-Controller\"
    -D PROJECT_VERSION=\"0.1.0\"
    
    ; Device configuration
    -D DEVICE_HOSTNAME=\"ESPlan-Boiler\"
    
    ; Enable MQTT
    -D ENABLE_MQTT=1
    ; MQTT Credentials are loaded from credentials.ini
    
    ; Ethernet PHY configuration
    -D ETH_PHY_MDC_PIN=23
    -D ETH_PHY_MDIO_PIN=18
    -D ETH_PHY_ADDR=0
    -D ETH_PHY_POWER_PIN=-1
    
    ; OTA configuration
    ; OTA_PASSWORD is loaded from credentials.ini
    -D OTA_PORT=3232
    
    ; Core assignment for App tasks
    -D CORE_APP=1                ; Core for app tasks
    
    ; Link-time optimization and performance flags
    -flto=auto                   ; Use all available CPU cores for LTO
    -ffat-lto-objects            ; Generate both LTO and regular object code
    -fuse-linker-plugin          ; Use LTO plugin during linking
    -O2                          ; Standard optimization
    -ffunction-sections          ; Place functions in separate sections
    -fdata-sections              ; Place data in separate sections
    -Wl,--gc-sections            ; Remove unused sections at link time
    -fno-exceptions              ; Disable exceptions if not needed
    -fmerge-all-constants        ; Merge identical constants
    -fdevirtualize-speculatively ; Aggressive devirtualization
    -finline-functions           ; Inline functions aggressively
    -funroll-loops               ; Unroll loops for performance
    -fomit-frame-pointer         ; Omit frame pointer for better optimization
    -fstack-usage                ; Generate stack usage info
    
    ; Enable custom logger globally for all libraries
    -DUSE_CUSTOM_LOGGER
    
    ; NTPClient Ethernet configuration
    -DNTP_UDP_IMPLEMENTATION=\"EthernetUdp.h\"
    -DNTP_UDP_CLASS=EthernetUDP
    
    ; Event-driven architecture is now the only implementation
    
    ; MB8ART async queue size (increased from default 8 to 15)
    -D PROJECT_MB8ART_ASYNC_QUEUE_SIZE=15
    
    ; Optimization flags to reduce flash usage
    -D CONFIG_ARDUHAL_LOG_DEFAULT_LEVEL=1  ; Keep Error logs from HAL
    ; -D CONFIG_NEWLIB_NANO_FORMAT=1       ; Commented out - would require floating point conversion

; -------------------------------------------------------------------
; Debug Selective - Strategic debug output for key areas
[base_debug_selective]
build_type = debug
monitor_filters = 
    esp32_exception_decoder
    default
build_flags = 
    ${base.build_flags}
    -DCMAKE_BUILD_TYPE=debug
    -DLOG_MODE_DEBUG_SELECTIVE   ; Strategic debug logging
    -DDEBUG_BUILD
    -DUSE_CUSTOM_LOGGER          ; Use our custom logger for all libraries
    -DESP32MQTTCLIENT_USE_LOGGER ; ESP32MQTTClient uses thread-safe Logger

    ; -DTASK_MANAGER_DEBUG         ; TaskManager debugging
    -DMONITOR_TASK_DEBUG         ; MonitoringTask debugging
    ; -DCONTROL_MODULE_DEBUG       ; Control module debugging

    -DMAIN_DEBUG
    -DETH_DEBUG
    -DOTA_DEBUG
    ; -DMODBUSDEVICE_DEBUG
    ; -DMB8ART_DEBUG               ; Disable MB8ART debug logging to reduce spam
    ; -DRYN4_DEBUG
    ; -DRYN4_ENABLE_OPTIMISTIC_UPDATES  ; RYN4: Disabled - mismatch counting solves false positives without optimistic updates
    ; -DANDRTF3_DEBUG              ; Enable ANDRTF3 debug to diagnose 0Â°C issue
    ; -DNTP_LOG_LEVEL=5            ; Enable verbose NTP logging
    ; -DNTP_DEBUG                  ; Enable NTP debug logging (includes verbose)

    -DCONFIG_FREERTOS_USE_STATS_FORMATTING_FUNCTIONS=1
    -DconfigUSE_TRACE_FACILITY=1
    -DCORE_DEBUG_LEVEL=4         ; Debug level to enable LOG_DEBUG
    -O0                          ; Disable optimizations
    -g3                          ; Detailed debugging info
    -ggdb3                       ; Debugging info for GDB
    -Wl,--undefined=uxTopUsedPriority ; Ensure uxTopUsedPriority is not discarded

; -------------------------------------------------------------------
; Debug Full - Maximum verbosity for deep troubleshooting
[base_debug_full]
build_type = debug
monitor_filters = 
    esp32_exception_decoder
    default
build_flags = 
    ${base.build_flags}
    -DCMAKE_BUILD_TYPE=debug
    -DLOG_MODE_DEBUG_FULL        ; Maximum verbosity
    -DDEBUG_BUILD
    -DUSE_CUSTOM_LOGGER          ; Use our custom logger for all libraries
    -DMAIN_DEBUG
    -DETH_DEBUG
    -DOTA_DEBUG
    ; -DMODBUSDEVICE_DEBUG
    ; -DMB8ART_DEBUG               ; Enable MB8ART debug logging
    ; -DRYN4_DEBUG
    ; -DESP32MODBUSRTU_DEBUG       ; ModbusRTU debugging
    ; -DESP32MODBUSMSG_DEBUG       ; ModbusMessage debugging
    -DTASK_MANAGER_DEBUG         ; TaskManager debugging
    -DMONITOR_TASK_DEBUG         ; MonitoringTask debugging
    -DCONTROL_MODULE_DEBUG       ; Control module debugging
    -DCONFIG_FREERTOS_USE_STATS_FORMATTING_FUNCTIONS=1
    -DconfigUSE_TRACE_FACILITY=1
    -DCORE_DEBUG_LEVEL=5         ; Enable verbose logging
    -O0                          ; Disable optimizations
    -g3                          ; Detailed debugging info
    -ggdb3                       ; Debugging info for GDB
    -Wl,--undefined=uxTopUsedPriority ; Ensure uxTopUsedPriority is not discarded

; -------------------------------------------------------------------
; Release - Minimal logging, optimized for production
[base_release]
build_flags =
    ${base.build_flags}
    -DLOG_MODE_RELEASE           ; Explicit release mode (though it's default)
    -Os                          ; Optimize for size
    -Werror                      ; Treat warnings as errors
    ; -DNDEBUG                   ; Uncomment to disable assert() calls

; -------------------------------------------------------------------
; Debugger configuration for hardware debugging
[base_debugger]
debug_tool = custom
debug_server =
    $PLATFORMIO_CORE_DIR/packages/tool-openocd-esp32/bin/openocd
    -d2
    -f "board/esp32-wrover-kit-3.3v.cfg"
debug_speed = 20000
board_build.f_cpu = 240000000L
debug_init_break = tbreak setup ; Break on setup() method start

; -------------------------------------------------------------------
; USB Debug Selective Configuration (Default development environment)
[env:esp32dev_usb_debug_selective]
extends = env_defaults, base_debug_selective, base_debugger
upload_port = /dev/ttyACM0
upload_speed = 921600
; Force selective debug mode by undefining full debug
build_unflags =
    -DLOG_MODE_DEBUG_FULL
build_flags =
    ${base_debug_selective.build_flags}
    ${credentials.build_flags}
    -ULOG_MODE_DEBUG_FULL        ; Explicitly undefine FULL mode
    -DLOG_MODE_DEBUG_SELECTIVE   ; Force SELECTIVE mode

; -------------------------------------------------------------------
; USB Debug Full Configuration (Deep troubleshooting)
[env:esp32dev_usb_debug_full]
extends = env_defaults, base_debug_full, base_debugger
upload_port = /dev/ttyACM0
upload_speed = 921600

; -------------------------------------------------------------------
; USB Release Configuration (Production)
[env:esp32dev_usb_release]
extends = env_defaults, base_release
upload_port = /dev/ttyACM0
upload_speed = 921600

; -------------------------------------------------------------------
; OTA Debug Selective Configuration
[env:esp32dev_ota_debug_selective]
extends = env_defaults, base_debug_selective
upload_protocol = espota
upload_port = 192.168.20.40    ; Change to your device IP
upload_flags =
    --host_ip=192.168.20.16      ; Change to your computer IP
    --auth=update-password

; -------------------------------------------------------------------
; OTA Debug Full Configuration
[env:esp32dev_ota_debug_full]
extends = env_defaults, base_debug_full
upload_protocol = espota
upload_port = 192.168.20.40    ; Change to your device IP
upload_flags =
    --host_ip=192.168.20.16      ; Change to your computer IP
    --auth=update-password

; -------------------------------------------------------------------
; OTA Release Configuration
[env:esp32dev_ota_release]
extends = env_defaults, base_release
upload_protocol = espota
upload_port = 192.168.20.40    ; Change to your device IP
upload_flags =
    --host_ip=192.168.20.16      ; Change to your computer IP
    --auth=update-password

; -------------------------------------------------------------------
; Test environment for general testing - RELEASE MODE
[env:esp32dev_test_release]
extends = env_defaults, base_release
build_flags = 
    ${base_release.build_flags}
    -DENABLE_MEMORY_LEAK_TEST    ; Enable automatic memory leak test

upload_port = /dev/ttyACM0
upload_speed = 921600

; -------------------------------------------------------------------
; Test environment for general testing - DEBUG SELECTIVE
[env:esp32dev_test_debug_selective]
extends = env_defaults, base_debug_selective
build_flags = 
    ${base_debug_selective.build_flags}
    -DENABLE_MEMORY_LEAK_TEST    ; Enable automatic memory leak test

upload_port = /dev/ttyACM0
upload_speed = 921600

; -------------------------------------------------------------------
; Base configuration without Logger support
[base_no_logger]
build_flags = 
    -Wall                        ; Enable all warnings
    -Wuninitialized              ; Warn about uninitialized variables
    -Wsign-compare               ; Warn about signed/unsigned comparisons
    ; -Wno-unused-const-variable   ; Suppress unused const variable warnings
    -std=gnu++11                 ; C++11 standard
    

    -D ARDUINO_ARCH_ESP32
    
    ; Serial/UART configuration for better log handling
    -D SERIAL_TX_BUFFER_SIZE=1024  ; Increase TX buffer
    -D SERIAL_RX_BUFFER_SIZE=256   ; Standard RX buffer

    ; Ethernet configuration
    -D CONFIG_ETH_ENABLED=1      ; Enable Ethernet
    -D CONFIG_ETH_USE_ESP32_EMAC=1
    -D ETH_PHY_INTERFACE=ETH_PHY_RMII
    -D ETH_RMII_CLK_OUTPUT=1
    -D ETH_RMII_CLK_OUT_GPIO=17
    
    ; Disable all wireless features
    ; Note: BT config values removed - framework defines them but we don't use BT
    ; -D CONFIG_BT_ENABLED=0       ; Removed - causes redefinition warning
    ; -D CONFIG_BT_BLE_ENABLED=0   ; Removed - causes redefinition warning
    ; -D CONFIG_BT_NIMBLE_ENABLED=0 ; Keep this to ensure NimBLE is disabled
    
    ; Disable unused features
    -D CONFIG_WIFI_ENABLED=0
    -D CONFIG_MDNS_DISABLE=1
    
    ; MQTT stack optimization
    -D CONFIG_MQTT_TASK_STACK_SIZE=4096
    
    ; Arduino v3.x specific flags
    -D ARDUINO_USB_MODE=0
    -D ARDUINO_USB_CDC_ON_BOOT=0
    
    ; Project identification
    -D PROJECT_NAME=\"ESPlan-Boiler-Controller\"
    -D PROJECT_VERSION=\"0.1.0\"
    
    ; Device configuration
    -D DEVICE_HOSTNAME=\"ESPlan-Boiler\"
    
    ; Enable MQTT
    -D ENABLE_MQTT=1
    ; MQTT Credentials are loaded from credentials.ini
    
    ; Ethernet PHY configuration
    -D ETH_PHY_MDC_PIN=23
    -D ETH_PHY_MDIO_PIN=18
    -D ETH_PHY_ADDR=0
    -D ETH_PHY_POWER_PIN=-1
    
    ; OTA configuration
    ; OTA_PASSWORD is loaded from credentials.ini
    -D OTA_PORT=3232
    
    ; Core assignment for App tasks (no BLE)
    -D CORE_APP=1
    
    ; Link-time optimization and performance flags
    -flto=auto
    -ffat-lto-objects
    -fuse-linker-plugin
    -O2
    -ffunction-sections
    -fdata-sections
    -Wl,--gc-sections
    -fno-exceptions
    -fmerge-all-constants
    -fdevirtualize-speculatively
    -finline-functions
    -funroll-loops
    -fomit-frame-pointer
    -fstack-usage
    
    ; NO LOGGER FLAGS!
    -DLOG_NO_CUSTOM_LOGGER
    
    ; Release mode settings
    -DLOG_MODE_RELEASE
    -Os                          ; Optimize for size
    -Werror                      ; Treat warnings as errors
    ; -DNDEBUG                   ; Uncomment to disable assert() calls

; -------------------------------------------------------------------
; NO LOGGER Configuration - Uses ESP-IDF logging only
[env:esp32dev_no_logger_release]
extends = env_defaults, base_no_logger
; Override lib_deps without Logger - uses GitHub URLs
lib_deps =
    ; Core utilities (NO Logger!)
    https://github.com/packerlschupfer/ESP32-LibraryCommon.git
    https://github.com/packerlschupfer/ESP32-SemaphoreGuard.git
    https://github.com/packerlschupfer/ESP32-MutexGuard.git
    https://github.com/packerlschupfer/ESP32-Watchdog.git
    https://github.com/packerlschupfer/ESP32-TaskManager.git

    ; Network and OTA
    https://github.com/packerlschupfer/ESP32-EthernetManager.git
    https://github.com/packerlschupfer/ESP32-OTAManager.git

    ; Time synchronization
    https://github.com/packerlschupfer/ESP32-NTPClient.git
    https://github.com/packerlschupfer/ESP32-DS3231Controller.git

    ; Storage
    https://github.com/packerlschupfer/ESP32-PersistentStorage.git
    https://github.com/packerlschupfer/ESP32-RuntimeStorage.git

    ; MQTT communication
    https://github.com/packerlschupfer/ESP32-MQTTClient.git
    https://github.com/packerlschupfer/ESP32-MQTTManager.git

    ; Modbus framework
    https://github.com/packerlschupfer/esp32ModbusRTU.git
    https://github.com/packerlschupfer/ESP32-IDeviceInstance.git
    https://github.com/packerlschupfer/ESP32-ModbusDevice.git

    ; Modbus hardware drivers
    https://github.com/packerlschupfer/ESP32-MB8ART.git
    https://github.com/packerlschupfer/ESP32-RYN4.git
    https://github.com/packerlschupfer/ESP32-ANDRTF3.git

    ; JSON support
    bblanchon/ArduinoJson@^7.4.2

upload_port = /dev/ttyACM0
upload_speed = 921600

; -------------------------------------------------------------------
; Test Environments
; -------------------------------------------------------------------

; Native platform tests (run on development machine)
[env:native_test]
platform = native
test_framework = unity
test_ignore = test_embedded
build_flags = 
    -std=c++11
    -DUNIT_TEST
    -DNATIVE_TEST
    -I include
    -I src
    -I src/config
    -I src/shared
    -I src/utils
    -I src/modules/control
lib_deps = 
    ; No external libraries needed for native tests

; ESP32 hardware tests
[env:esp32_test]
extends = env_defaults, base
test_framework = unity
build_flags =
    ${base.build_flags}
    -DUNIT_TEST
    -DESP32_TEST
test_ignore = test_native

; ===================================================================
; PRODUCTION Environment (via usbip from 192.168.16.62)
; Connect: sudo modprobe vhci-hcd && sudo usbip attach -r 192.168.16.62 -b 1-1.3
; ===================================================================
[base_prod]
upload_port = /dev/ttyACM0
monitor_port = /dev/ttyACM0
build_unflags =
    -DDEVICE_HOSTNAME=\"ESPlan-Boiler\"
build_flags =
    -DDEVICE_HOSTNAME=\"ESPlan-Boiler\"
    -DETH_STATIC_IP=192,168,20,40
    -DMQTT_SERVER=\"192.168.20.27\"

[env:prod_debug_selective]
extends = env_defaults, base_debug_selective, base_debugger, base_prod
build_flags =
    ${base_debug_selective.build_flags}
    ${credentials.build_flags}
    ${base_prod.build_flags}

[env:prod_release]
extends = env_defaults, base_release, base_prod
build_flags =
    ${base_release.build_flags}
    ${credentials.build_flags}
    ${base_prod.build_flags}

[env:prod_ota]
extends = env_defaults, base_release, base_prod
upload_protocol = espota
upload_port = 192.168.20.40
upload_flags =
    --host_ip=192.168.20.16
    --auth=update-password
build_flags =
    ${base_release.build_flags}
    ${credentials.build_flags}
    ${base_prod.build_flags}

; ===================================================================
; DEVELOPMENT Environment (local USB)
; ===================================================================
[base_dev]
upload_port = /dev/ttyACM1
monitor_port = /dev/ttyACM1
build_unflags =
    -DDEVICE_HOSTNAME=\"ESPlan-Boiler\"
build_flags =
    -DDEVICE_HOSTNAME=\"ESPlan-Boiler-Dev\"
    -DETH_STATIC_IP=192,168,20,41
    -DMQTT_SERVER=\"192.168.20.16\"

[env:dev_debug_selective]
extends = env_defaults, base_debug_selective, base_debugger, base_dev
build_flags =
    ${base_debug_selective.build_flags}
    ${credentials.build_flags}
    ${base_dev.build_flags}

[env:dev_debug_full]
extends = env_defaults, base_debug_full, base_debugger, base_dev
build_flags =
    ${base_debug_full.build_flags}
    ${credentials.build_flags}
    ${base_dev.build_flags}

[env:dev_release]
extends = env_defaults, base_release, base_dev
build_flags =
    ${base_release.build_flags}
    ${credentials.build_flags}
    ${base_dev.build_flags}

[env:dev_ota]
extends = env_defaults, base_release, base_dev
upload_protocol = espota
upload_port = 192.168.20.41
upload_flags =
    --host_ip=192.168.20.16
    --auth=update-password
build_flags =
    ${base_release.build_flags}
    ${credentials.build_flags}
    ${base_dev.build_flags}
